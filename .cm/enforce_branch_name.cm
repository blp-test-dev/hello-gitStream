# -*- mode: yaml -*-
manifest:
  version: 1.0
automations:
  enforce_branch_name: 
    if:  
      - {{ branch.name | match(regex=branchConvention.requiredPrefixes) | nope }}
      - {{ branch.name | match(regex=branchConvention.branchRegex) | nope }}
      - {{ branch.name | match(regex=branchConvention.ignoreList) | nope }}
    run:
      - action: add-label@v1
        args:
          label: "‚ùó Incorrect Branch Name"
          color: {{ colors.red }}
      - action: add-comment@v1
        args:
          comment: |
            All PR branch names must be prefixed by feature, stable, or fix, and must contain a reference to a Jira ticket. E.g. 'feature-abc-1234'
            Please move your changes to a new branch that meets these requirements and open a new PR.
      - action: close@v1

branchConvention:
  requiredPrefixes: r/^(feature|stable|fix)/

  # This matches Jira ticket naming conventions, modify the regex to suit your project
  branchRegex: '\b[A-Za-z]+-\d+\b'

  ignoreList: r/^(development|staging)/

colors:
  red: 'b60205'
